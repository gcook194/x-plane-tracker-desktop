<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Leaflet Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css" />
    <style>
        html, body {
          margin: 0;
          padding: 0;
          height: 100%;
          width: 100%;
        }

        #map {
          height: 100%;
          width: 100%;
        }

        .white-dot-icon {
          background-color: white;
          border-radius: 50%;
          width: 8px;
          height: 8px;
          border: 1px solid rgba(255,255,255,0.6);
        }

        #map {
            background-color: #252525;
        }
    </style>
</head>
<body>
<div id="map"></div>
<script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js"></script>
<script>
    var markers = [];
    var map;

    var whiteDotIcon = L.icon({
      iconUrl: 'data:image/svg+xml;base64,' + btoa(`
        <svg xmlns="http://www.w3.org/2000/svg" width="8" height="8">
          <circle cx="4" cy="4" r="3" fill="white" />
        </svg>
      `),
      iconSize: [9, 9],      // actual size of the icon
      iconAnchor: [4, 4],    // center the dot on the lat/lng
      popupAnchor: [0, -4]   // adjust popup position
    });

    function loadMap() {
        if (map != null) {
            markers = [];
            map.off();
            map.remove();
        }

        map = L.map('map').fitWorld();
        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
          attribution: '&copy; <a href="https://carto.com/">CARTO</a>',
          maxZoom: 19
        }).addTo(map);
    }

    function addMarkerToMap(lat, lng, label) {
        const marker = L.marker([lat, lng], { icon: whiteDotIcon }).addTo(map).bindPopup(label);
        markers.push(marker);
    }

    function drawBasicRouteLine() {
        if (markers.length > 1) {
            for (var i = 0; i < markers.length; i++) {
                if (markers[i+1] != null) {
                    const startLine = markers[i].getLatLng();
                    const endLine = markers[i+1].getLatLng();

                    L.polyline([startLine, endLine], {
                        color: 'white',
                        opacity: 0.8,
                        weight: 1,
                        dashArray: '4, 6'
                    }).addTo(map);
                }
            }
        }
    }

    function drawActualRouteLine(latLongs) {
        const flightPath = L.polyline(latLongs, {
            weight: 1,
            opacity: 0.8,
            smoothFactor: 1
        }).addTo(map);

        map.fitBounds(flightPath.getBounds());
    }

    function fitToAllMarkers() {
        if (markers.length > 0) {
            var group = L.featureGroup(markers);
            map.fitBounds(group.getBounds());
        }
    }
</script>
</body>
</html>
